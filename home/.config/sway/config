################################################################################
# Loading env vars
# Or trying to...
#  And we do want xwayland enable for "legacy" apps
    exec /home/diraol/.diraol/rc
    #exec_always "source /home/diraol/.diraol/rc; systemctl --user start sway-session.target; systemctl --user import-environment PATH"
    xwayland enable

################################################################################
#  Variables
#  Mod1 = for Alt.
#  Mod4 = Logo key
    set $mod Mod1
    set $mods Mod1+Shift
    set $amod Mod4
    set $amods Mod4+Shift

################################################################################
#  Your preferred terminal emulator
    set $term x-terminal-emulator

################################################################################
##  Your preferred application launcher
#  Some other options:
#  set $menu j4-dmenu-desktop --dmenu="dmenu -i" --term="i3-sensible-terminal"
#  set $menu dmenu_path | dmenu | xargs swaymsg exec --
#  set $menu j4-dmenu-desktop --dmenu="(cat ; (stest -flx $(echo ${PATH} | tr : ' ') | sort -u)) | bemenu -i" --term="i3-sensible-terminal"
#  set $menu (cat ; (stest -flx $(echo ${PATH} | tr : ' ') | sort -u)) | bemenu -i | wofi --show drun -i | xargs swaymsg exec --
#  set $menu wofi --show drun -i | xargs swaymsg exec --
    set $menu wofi --show drun -i

################################################################################
### Idle configuration
# This will lock your screen after 300 seconds of inactivity, then turn off
# your displays after another 300 seconds, and turn your screens back on when
# resumed. It will also lock your screen before your computer goes to sleep.
    exec swayidle -w \
             timeout 600 'swaylock -f -c 000000' \
             timeout 900 'swaymsg "output * dpms off"' \
                  resume 'swaymsg "output * dpms on"; swaymsg exec /home/diraol/.local/bin/monitor_setup' \
             before-sleep 'swaylock -f -c 000000'

    bindsym Ctrl+Alt+l exec swaylock -f -c 222222

################################################################################
### Input configuration
# You can get the names of your inputs by running: swaymsg -t get_inputs
# Read `man 5 sway-input` for more information about this section.
# TODO inputs
    input type:keyboard xkb_layout us
    input type:keyboard xkb_variant intl

### Key bindings
#
# Basics:
#
    # Start a terminal
    bindsym $mod+Return exec $term

    # Kill focused window
    bindsym $mods+q kill

    # Start your launcher
    bindsym $mod+d exec $menu

    # Drag floating windows by holding down $mod and left mouse button.
    # Resize them with right mouse button + $mod.
    # Despite the name, also works for non-floating windows.
    # Change normal to inverse to use left mouse button for resizing and right
    # mouse button for dragging.
    floating_modifier $mod normal

    # Reload the configuration file
    bindsym $mods+r reload

    # Exit sway (logs you out of your Wayland session)
    bindsym $mods+e exec swaynag -t warning -m 'You pressed the exit shortcut. Do you really want to exit sway? This will end your Wayland session.' -b 'Yes, exit sway' 'swaymsg exit'

# Multimedia
bindsym --locked $mod+equal exec --no-startup-id pactl set-sink-volume $(pacmd list-sinks |awk '/* index:/{print $3}') +5%
bindsym --locked XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume $(pacmd list-sinks |awk '/* index:/{print $3}') +5%
bindsym --locked $mod+minus exec --no-startup-id pactl set-sink-volume $(pacmd list-sinks |awk '/* index:/{print $3}') -5%
bindsym --locked XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume $(pacmd list-sinks |awk '/* index:/{print $3}') -5%
bindsym --locked XF86AudioMute exec --no-startup-id pactl set-sink-mute $(pacmd list-sinks |awk '/* index:/{print $3}') toggle
bindsym --locked XF86AudioPlay exec playerctl play-pause
bindsym --locked XF86AudioNext exec playerctl next
bindsym --locked XF86AudioPrev exec playerctl previous

# Brightness controls
bindsym --locked XF86MonBrightnessUp exec --no-startup-id brightnessctl set +10%
bindsym --locked $mods+equal exec --no-startup-id brightnessctl set +10%
bindsym --locked XF86MonBrightnessDown exec --no-startup-id brightnessctl set 10%-
bindsym --locked $mods+minus exec --no-startup-id brightnessctl set 10%-

# Print Screen / Screenshot
bindsym --locked Shift+Print exec --no-startup-id grim -g "$(slurp)" "${HOME}/sandbox/screenshot_$(date +%Y-%m-%d_%Hh%Mm%Ss).png"
bindsym --locked Print exec --no-startup-id grim -g "$(slurp)" - | wl-copy

#
# Moving around:
#
    # Move your focus around
    # bindsym $mod+$left focus left
    # bindsym $mod+$down focus down
    # bindsym $mod+$up focus up
    # bindsym $mod+$right focus right
    # Or use $mod+[up|down|left|right]
    bindsym $mod+Left focus left
    bindsym $mod+Down focus down
    bindsym $mod+Up focus up
    bindsym $mod+Right focus right

    # Move the focused window with the same, but add Shift
    # bindsym $mod+Shift+$left move left
    # bindsym $mod+Shift+$down move down
    # bindsym $mod+Shift+$up move up
    # bindsym $mod+Shift+$right move right
    # Ditto, with arrow keys
    bindsym $mods+Left move left
    bindsym $mods+Down move down
    bindsym $mods+Up move up
    bindsym $mods+Right move right

# Outputs/Monitors and workspaces positioning
    include outputs
    include workspaces

    # Specific workspaces apps
    assign [app_id="personalfox"] →  workspace $wsp
    assign [app_id="deezer"] →  workspace $wsd
    assign [class="[Tt]elegram.*"] →  workspace $wst
    assign [class="[Ff]ranz"] →  workspace $wsm

#
# Layout stuff:
#
    # You can "split" the current object of your focus with
    # $mod+b or $mod+v, for horizontal and vertical splits
    # respectively.
    bindsym $mod+h splith
    bindsym $mod+v splitv

    # Switch the current container between different layout styles
    # bindsym $mod+s layout stacking
    bindsym $mod+w layout tabbed
    bindsym $mod+e layout toggle split

    # Sticky mode for floating windows. The sticked window stay visible on all 
    # workspaces.
    bindsym $mod+s sticky toggle

    # Make the current focus fullscreen
    bindsym $mod+f fullscreen

    # Toggle the current focus between tiling and floating mode
    bindsym $mods+space floating toggle

    # Swap focus between the tiling area and the floating area
    bindsym $mod+space focus mode_toggle

    # Move focus to the parent container
    bindsym $mod+a focus parent

#
# Scratchpad:
#
    # Move the currently focused window to the scratchpad
    bindsym Mod5+Shift+minus move scratchpad

    # Show the next scratchpad window or hide the focused scratchpad window.
    # If there are multiple scratchpad windows, this command cycles through them.
    bindsym Mod5+minus scratchpad show

    mode "$scratchpad" {
        # audio
        bindsym a [app_id="pavucontrol"] scratchpad show
        # calendar
        bindsym c [app_id="gnome-calendar"] scratchpad show
        # keepass
        bindsym k [class="keepassxc"] scratchpad show

        # back to normal: Enter or Escape
        bindsym Return mode "default"
        bindsym Escape mode "default"
    }
    # Enter scratchpad mode
    bindsym $mods+s mode "$scratchpad"

    # Volume control floating
    for_window [app_id="pavucontrol"] floating enable

    # General Application Selection
    for_window [title="Launch Application"] floating enable
    # Zoom Chat floating
    for_window [title="Zoom Group Chat"] floating enable
    for_window [title="Zoom - Pro Account"] floating enable
    for_window [instance="zoom" title="Settings"] floating enable

    # Keepass scratchpad
    for_window [class="(?i)keepassxc"] floating enable
    for_window [class="(?i)keepassxc"] move scratchpad
    for_window [class="(?i)keepassxc"] scratchpad show
    bindsym $amods+k [class="(?i)keepassxc"] scratchpad show

    # Firefox
    for_window [title="Firefox - Sharing Indicator"] floating enable

    # Bluetooth Manager
    for_window [app_id="blueman-manager"] floating enable

    # Gsimplecal
    bindsym $mod+c exec gsimplecal

#
# Resizing containers:
#
mode "resize" {
    bindsym Left resize shrink width 10px
    bindsym Down resize grow height 10px
    bindsym Up resize shrink height 10px
    bindsym Right resize grow width 10px

    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+r mode "resize"

# set primary gruvbox colorscheme colors
set $bg #282828
set $red #cc241d
set $green #98971a
set $yellow #d79921
set $blue #458588
set $purple #b16286
set $aqua #689d68
set $gray #a89984
set $darkgray #1d2021
set $white #ebdbb2

#
# Status Bar:
#
# Read `man 5 sway-bar` for more information about this section.
bar {
    swaybar_command waybar
}

include theme

#end of window title bars & borders section

include /etc/sway/config.d/*

include init

# Start at workspace 1
workspace 1
